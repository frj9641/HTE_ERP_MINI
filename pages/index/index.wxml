<view class="box">
  <view class="shop-name">
    <view class="name">八方城店</view>
  </view>
</view>
<view class="box1">
  <view class="box-1">
    <van-sidebar>
      <van-sidebar-item title="入库" bindtap="inputBar" />
      <van-sidebar-item title="出库" bindtap="outputBar" />
      <van-sidebar-item title="历史" bindtap="historyBar" />
    </van-sidebar>
  </view>
  <scroll-view class="box-2" scroll-y="true" scroll-top="{{scrolltop}}">

    <van-card wx:if="{{bar == 'i'||bar == 'o'}}" wx:for="{{chemicals}}" centered="true" lazy-load="true"
      num="{{item.storage}}" title="{{item.chemicalPO.chemicalName}}"
      thumb="https://dcdn.it120.cc/2020/08/01/75418f1b-1d4d-48ad-a7b7-85db05f7e699.jfif" thumb-mode="aspectFill">
      <view class="goods-btn" slot="footer">
        <van-icon name="{{bar == 'i' ? 'add' : 'clear'}}" color="{{bar == 'i' ? '#e64340' : '#228B22'}}" size="50rpx"
          data-idx="{{index}}" bind:click="showGoodsDetailPOP" />
      </view>
    </van-card>

    <van-cell-group wx:if="{{bar == 'h'}}">
      <van-cell title-class="{{item.providerId==null?'outHistory' : 'inHistory'}}" wx:for="{{history}}"
        title="{{item.chemicalName}}*{{item.amount}}吨 " value="{{item.date}}{{item.providerId==null?'出库':'入库'}}"
        label="{{item.providerId==null?'':'供应商:'+item.providerName+' 费用:'+item.money+'元'}}" />
      <!-- '供应商:'+item.providerName+' 单价:'+item.price+'元/吨 运费:'+item.carriage+'元/吨 费用:'+item.money+'元' -->
    </van-cell-group>
  </scroll-view>
</view>

<van-popup show="{{ showGoodsDetailPOP }}" custom-style="max-height: 80%;z-index:99999;" closeable close-icon="close"
  position="bottom" bind:close="hideGoodsDetailPOP">
  <view class="title-name">{{chemical.chemicalPO.chemicalName}}</view>

  <view class="content-1" wx:if="{{bar == 'i'}}">
    <view class="title">供应商</view>
    <view class="box-1">
      <view wx:for="{{chemical.providerPOList}}" class="title-1 {{selectedProvierId==item.providerId?'active':''}}"
        data-idx="{{item.providerId}}" data-name="{{item.providerName}}" bindtap="skuClick">{{item.providerName}}</view>
    </view>
  </view>

  <view class="content-1">
    <view class="title">数量</view>
    <van-cell-group>
      <van-field value="{{amount}}" placeholder="吨" type="number" label="{{bar=='i'?'入库吨数':'出库吨数'}}"
        bind:change="amountChange" />
    </van-cell-group>
  </view>

  <view class="content-1" wx:if="{{bar == 'i'}}">
    <view class="title">单价</view>
    <van-cell-group>
      <van-field value="{{price}}" placeholder="吨/元" type="number" label="货品单价" bind:change="priceChange" />
    </van-cell-group>
  </view>

  <view class="content-1" wx:if="{{bar == 'i'}}">
    <view class="title">运费</view>
    <van-cell-group>
      <van-field value="{{carriage}}" placeholder="吨/元" type="number" label="货品运费" bind:change="carriageChange" />
    </van-cell-group>
  </view>

  <view class="blank"></view>
  <view class="add-bar">
    <view class="add-box" wx:if="{{bar == 'i'}}">
      <view class="price">
        <text>¥</text>
        <view wx:if="{{amount&&price&&carriage}}">
          {{money}}
        </view>
      </view>
    </view>
    <view class="add-cart">
      <van-button block color="{{bar == 'i' ? '#e64340' : '#228B22'}}" bind:click="updateRep">{{bar=='i'?'加入库存':'移出库存'}}
      </van-button>
    </view>
  </view>
</van-popup>